CREATE TEMP TABLE delete_facebook_insights_9579a118bfa94eafabf0625536b05e4c AS SELECT d."_dlt_id" FROM "facebook_insights_dataset"."facebook_insights" as d WHERE EXISTS (SELECT 1 FROM "facebook_insights_dataset_staging"."facebook_insights" as s WHERE d."campaign_id" = s."campaign_id" AND d."adset_id" = s."adset_id" AND d."ad_id" = s."ad_id" AND d."date_start" = s."date_start");
DELETE FROM "facebook_insights_dataset"."facebook_insights__website_ctr"             WHERE "_dlt_root_id" IN (                 SELECT * FROM delete_facebook_insights_9579a118bfa94eafabf0625536b05e4c             );         
DELETE FROM "facebook_insights_dataset"."facebook_insights__action_values"             WHERE "_dlt_root_id" IN (                 SELECT * FROM delete_facebook_insights_9579a118bfa94eafabf0625536b05e4c             );         
DELETE FROM "facebook_insights_dataset"."facebook_insights__actions"             WHERE "_dlt_root_id" IN (                 SELECT * FROM delete_facebook_insights_9579a118bfa94eafabf0625536b05e4c             );         
DELETE FROM "facebook_insights_dataset"."facebook_insights__cost_per_action_type"             WHERE "_dlt_root_id" IN (                 SELECT * FROM delete_facebook_insights_9579a118bfa94eafabf0625536b05e4c             );         
DELETE FROM "facebook_insights_dataset"."facebook_insights"             WHERE "_dlt_id" IN (                 SELECT * FROM delete_facebook_insights_9579a118bfa94eafabf0625536b05e4c             );         
CREATE TEMP TABLE insert_facebook_insights_3f24587b2e19ecd1ca0cec18285cf182 AS              SELECT "_dlt_id"                 FROM (                     SELECT ROW_NUMBER() OVER (partition BY "campaign_id", "adset_id", "ad_id", "date_start" ORDER BY (SELECT NULL)) AS _dlt_dedup_rn, "_dlt_id"                     FROM "facebook_insights_dataset_staging"."facebook_insights"                 ) AS _dlt_dedup_numbered WHERE _dlt_dedup_rn = 1 AND (1 = 1)         ;
INSERT INTO "facebook_insights_dataset"."facebook_insights"("campaign_id", "adset_id", "ad_id", "date_start", "date_stop", "reach", "impressions", "frequency", "clicks", "unique_clicks", "ctr", "unique_ctr", "cpc", "cpm", "cpp", "spend", "account_id", "_dlt_load_id", "_dlt_id") SELECT "campaign_id", "adset_id", "ad_id", "date_start", "date_stop", "reach", "impressions", "frequency", "clicks", "unique_clicks", "ctr", "unique_ctr", "cpc", "cpm", "cpp", "spend", "account_id", "_dlt_load_id", "_dlt_id" FROM "facebook_insights_dataset_staging"."facebook_insights" WHERE "_dlt_id" IN (SELECT * FROM insert_facebook_insights_3f24587b2e19ecd1ca0cec18285cf182);
INSERT INTO "facebook_insights_dataset"."facebook_insights__website_ctr"("action_type", "value", "_dlt_root_id", "_dlt_parent_id", "_dlt_list_idx", "_dlt_id") SELECT "action_type", "value", "_dlt_root_id", "_dlt_parent_id", "_dlt_list_idx", "_dlt_id" FROM "facebook_insights_dataset_staging"."facebook_insights__website_ctr" WHERE "_dlt_root_id" IN (SELECT * FROM insert_facebook_insights_3f24587b2e19ecd1ca0cec18285cf182);
INSERT INTO "facebook_insights_dataset"."facebook_insights__action_values"("action_type", "value", "_1d_view", "_7d_click", "_dlt_root_id", "_dlt_parent_id", "_dlt_list_idx", "_dlt_id") SELECT "action_type", "value", "_1d_view", "_7d_click", "_dlt_root_id", "_dlt_parent_id", "_dlt_list_idx", "_dlt_id" FROM "facebook_insights_dataset_staging"."facebook_insights__action_values" WHERE "_dlt_root_id" IN (SELECT * FROM insert_facebook_insights_3f24587b2e19ecd1ca0cec18285cf182);
INSERT INTO "facebook_insights_dataset"."facebook_insights__actions"("action_type", "value", "_1d_view", "_7d_click", "_dlt_root_id", "_dlt_parent_id", "_dlt_list_idx", "_dlt_id") SELECT "action_type", "value", "_1d_view", "_7d_click", "_dlt_root_id", "_dlt_parent_id", "_dlt_list_idx", "_dlt_id" FROM "facebook_insights_dataset_staging"."facebook_insights__actions" WHERE "_dlt_root_id" IN (SELECT * FROM insert_facebook_insights_3f24587b2e19ecd1ca0cec18285cf182);
INSERT INTO "facebook_insights_dataset"."facebook_insights__cost_per_action_type"("action_type", "value", "_1d_view", "_7d_click", "_dlt_root_id", "_dlt_parent_id", "_dlt_list_idx", "_dlt_id") SELECT "action_type", "value", "_1d_view", "_7d_click", "_dlt_root_id", "_dlt_parent_id", "_dlt_list_idx", "_dlt_id" FROM "facebook_insights_dataset_staging"."facebook_insights__cost_per_action_type" WHERE "_dlt_root_id" IN (SELECT * FROM insert_facebook_insights_3f24587b2e19ecd1ca0cec18285cf182);